# 英雄通信协议

# CAN通信使用兵种

**英雄**（哨兵使用**USB串口**进行通信）

# CAN通信使用的帧格式

```cpp
struct can_frame {
    canid_t can_id; // CAN 标识符
    __u8 can_dlc;   //数据场的长度
    __u8 data[8];   //数据
};
```

* `can_id`​：CAN帧ID，用于标识CAN帧，十六进制
* `can_dlc`​：CAN帧**u8数组**的长度，十进制即可（0~8）
* `data[8]`​：CAN帧数据
  * `__u8`​：**无格式**8位二进制数据，需要上下位机自行转换相应数据
  * 数组长度最高为**8**，一个data最多存储8位二进制

# 通信协议

* CAN ID

  * 上位机：

    * `0x010`​：yaw，pitch数据发送帧
    * `0x012`​：标志位帧
  * *下位机：*
    * *`0x011`​：yaw，pitch数据发送帧*
    * *`0x013`​：标志位帧*
* CAN Data

  * 上位机

    * ID：0x010：

      |Index|Info|
      | :-----: | :-----------------------------: |
      |1|目标对应yaw值偏差量（×100）高8位|
      |2|目标对应yaw值偏差量（×100）低8位|
      |3|目标对应pitch值偏差量（×100）高8位|
      |4|目标对应pitch值偏差量（×100）低8位|
    * ID：0x012：
    
      |Index|Info|
      | :-----: | :------------------------------------------------------------------------: |
      |1|target_exist：目标存在标志位，用于告知下位机发现目标，以进行对云台接管<br />|
  * 下位机
  
    * 0x011：
  
      |Index|Info|
      | :-----: | :-------------------------: |
      |1|当前yaw值（×100）高8位|
      |2|当前yaw值（×100）低8位|
      |3|当前pitch值（×100）高8位|
      |4|当前pitch值（×100）低8位|
      |5||
      |6||
      |7||
      |8||
    * 0x013
  
      |Index|Info|
      | :-----: | :-----------------------------------------------------------------: |
      |1|mode：自瞄模式标志位，0：自瞄模式；1：前哨站模式<br />|
      |2|reboot：重启自瞄标志位，1：重启|

‍
